{
    "spec_version": 5,
    "project": "dough",
    "sequence_length": 2048,
    "micro_batch_size": 1,
    "target_batch_size": 1024,
    "batch_size": 192,
    "inner_steps": 15,
    "outer_learning_rate": 1.0,
    "blocks_per_window": 65,
    "windows_per_weights": 5,
    "momentum_decay": 0.95,
    "topk_compression": 128,
    "target_chunk": 64,
    "binary_score_ma_alpha": 0.05,
    "moving_average_window": 5,
    "model_size": "70B",
    "weight_decay": 0.1,
    "validator_offset": 1,
    "checkpoint_frequency": 20,
    "gather_peer_count": 20,
    "gather_share": 0.75,
    "gather_top_ratio": 2.0,
    "reserve_peer_count": 10,
    "reserve_decay_ratio": 0.5,
    "minimum_peers": 1,
    "peer_replacement_frequency": 5,
    "peer_list_window_margin": 1,
    "active_check_interval": 100,
    "recent_windows": 5,
    "power_normalisation": 2.0,
    "validator_sample_micro_bs": 8,
    "gather_peers_slash_threshold": 0.4,
    "uids_per_window": 10,
    "time_window_delta_seconds": 60,
    "reset_inactivity_windows": 10,
    "sync_max_steps_behind": 3,
    "eval_lr_factor": 0.2,
    "openskill_beta": 7,
    "openskill_tau": 0.1,
    "checkpoint_init_version": null,
    "num_evaluation_bins": 5,
    "quantization_bins": 4,
    "quantization_range": 6,
    "burn_rate": 0.5,
    "idx_overlap_threshold": 0.4,
  "optimizer": {
    "type": "adamw",
    "adamw": {
      "betas": [0.9, 0.95],
      "eps": 1e-8,
      "weight_decay": 0.1,
      "learning_rate": 1.2e-4,
      "scheduler": {
        "warmup_steps": 1000,
        "t_max": 20000,
        "eta_min_factor": 0.1
      }
    },
    "muon": {
      "momentum": 0.95,
      "weight_decay": 0.01,
      "head_lr_scale": 0.2,
      "embed_lr_scale": 0.2,
      "scalar_lr_scale": 0.2,
      "learning_rate": 2e-3,
      "scheduler": {
        "warmup_steps": 1000,
        "t_max": 20000,
        "eta_min_factor": 0.1
      }
    }
  },
  "torchtitan": {
    "tp_degree": 1,
    "pp_degree": 1,
    "cp_degree": 1,

    "dp_replicate": 1,
    "dp_shard": 8,

    "compile": true,
    "enable_cpu_offload": false,

    "mixed_precision_param": "bfloat16",
    "mixed_precision_reduce": "float32",

    "enable_async_tensor_parallel": false,
    "disable_loss_parallel": true,
    "fsdp_reshard_after_forward": "default",
    "enable_compiled_autograd": false,

    "float8_recipe_name": null,

    "activation_checkpoint": {
      "mode": "selective",
      "option": "op"
    }
  }
}
